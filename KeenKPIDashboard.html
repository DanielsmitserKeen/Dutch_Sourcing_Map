<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SaaS KPI Benchmarks – ARR • Churn • Growth</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.3.2/papaparse.min.js"></script>
  <style>
    body { background:#f8fafc; }
    h2 { scroll-margin-top: 90px; }
    table th { background:#f1f5f9; position: sticky; top: 0; }
    .card { background:#fff; border:1px solid #e2e8f0; border-radius:16px; box-shadow: 0 2px 10px rgba(2,6,23,.04); }
    .section-title { color:#0f172a }
    .chip { background:#e2e8f0; color:#0f172a; border-radius:9999px; font-size:.75rem; padding:.15rem .5rem; }
    .muted { color:#64748b }
    .loader { animation: pulse 1.2s ease-in-out infinite; }
    @keyframes pulse { 0%,100%{opacity:.35} 50%{opacity:1} }
  </style>
</head>
<body class="text-slate-800">
  <div class="max-w-6xl mx-auto p-6 space-y-10">

    <!-- ===== Header ===== -->
    <header class="flex items-center justify-between">
      <div>
        <h1 class="text-2xl font-bold">SaaS KPI Benchmarks (Live uit Google Sheets)</h1>
        <p class="muted mt-1">ARR-ranges, Churn en Growth – automatisch geladen uit je Sheet tabs.</p>
      </div>
      <nav class="hidden md:flex gap-2">
        <a href="#arr" class="chip">ARR Benchmarks</a>
        <a href="#churn" class="chip">Churn</a>
        <a href="#growth" class="chip">Growth</a>
      </nav>
    </header>

    <!-- ===== ARR Section placeholder ===== -->
    <section id="arr" class="space-y-3">
      <h2 class="text-xl font-semibold section-title">ARR Benchmarks per ARR-segment</h2>
      <p class="muted text-sm">Bron: tab <em>Standard KPI</em> uit je sheet.</p>
      <div id="arr-tabs" class="flex flex-wrap gap-2"></div>
      <div id="arr-blocks" class="space-y-8">
        <div class="loader text-sm">ARR data laden…</div>
      </div>
    </section>

    <!-- ===== CHURN Section ===== -->
    <section id="churn" class="space-y-3">
      <h2 class="text-xl font-semibold section-title">Churn Benchmarks (SMB/SME SaaS)</h2>
      <p class="muted text-sm">Bron: tab <em>Churn</em> uit je sheet.</p>
      <div id="churn-table" class="card overflow-x-auto">
        <div class="p-4 loader text-sm">Churn data laden…</div>
      </div>
    </section>

    <!-- ===== GROWTH Section ===== -->
    <section id="growth" class="space-y-3">
      <h2 class="text-xl font-semibold section-title">Growth Benchmarks</h2>
      <p class="muted text-sm">Bron: tab <em>Growth</em>.</p>
      <div id="growth-sections" class="space-y-8">
        <div class="p-4 loader text-sm">Growth data laden…</div>
      </div>
    </section>

  </div>

<script>
/* ===== URLs ===== */
const CHURN_PUBHTML = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTeXJAw0oVjkxxIKHXjLNlOomV7xIb8K8_lcJK68ctSPDG0XuaocDrCOqPObq0-PDgdLUEWbp1fbhzg/pubhtml#gid=121452829";

function pubhtmlToCsv(url) {
  const base = url.split("/pubhtml")[0];
  const gid = url.split("#gid=")[1];
  return `${base}/pub?gid=${gid}&single=true&output=csv`;
}

function toLinks(text) {
  if (!text) return "";
  const urls = text.match(/https?:\/\/\S+/g) || [];
  return urls.map(u => `<a href="${u}" target="_blank" class="text-blue-600 hover:underline">${u}</a>`).join("<br>");
}

/* ===== CHURN MODULE ===== */
(function ChurnModule(){
  const churnCsv = pubhtmlToCsv(CHURN_PUBHTML);
  const target = document.getElementById("churn-table");

  Papa.parse(churnCsv, {
    download: true,
    complete: res => {
      const rows = res.data.filter(r => r.some(cell => cell && String(cell).trim() !== ""));
      const headerRow = rows[0].map(h => h.trim().toLowerCase());
      const dataRows = rows.slice(1);

      const colIndex = {
        arr: headerRow.indexOf("arr segment"),
        monthly: headerRow.indexOf("monthly churn"),
        annual: headerRow.indexOf("annual churn"),
        src: headerRow.indexOf("bronnen")
      };

      const html = `
        <table class="min-w-full text-sm">
          <thead>
            <tr class="border-b border-slate-200 text-left text-slate-600">
              <th class="px-4 py-3">ARR Segment</th>
              <th class="px-4 py-3">Monthly Churn</th>
              <th class="px-4 py-3">Annual Churn</th>
              <th class="px-4 py-3">Bronnen</th>
            </tr>
          </thead>
          <tbody>
            ${dataRows.map(r => `
              <tr class="border-b border-slate-100 hover:bg-slate-50">
                <td class="px-4 py-2">${r[colIndex.arr] || ""}</td>
                <td class="px-4 py-2">${r[colIndex.monthly] || ""}</td>
                <td class="px-4 py-2">${r[colIndex.annual] || ""}</td>
                <td class="px-4 py-2">${toLinks(r[colIndex.src])}</td>
              </tr>
            `).join("")}
          </tbody>
        </table>
      `;
      target.innerHTML = html;
    }
  })
})();
</script>
</body>
</html>
